apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: ${namespace:=kanidm}

resources:
  - manifests/namespace.yaml
  - flux/helm-release.yaml

components:
  - ../../../components/common-kustomizeconfig
  - ../../../components/common-middlewares
  - ../../../components/namespace-cert-kanidm
  - ../../../components/bjw-s-helm-repository

secretGenerator:
  - name: kanidm-secret-values
    files:
      - values.yaml=values/secret-values.sops.yaml # TODO extract secret from helm
